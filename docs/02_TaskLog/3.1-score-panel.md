# Task 3.1: 左右チームのスコア表示パネル

## 実装予測（Plan モードでの分析）
- ScorePanel.tsx を新規作成（左右サイドは内部ローカルコンポーネントとして実装）
- スコア数字のフォントサイズは `useWindowDimensions()` で画面高さの35%程度を動的計算
- `glowStyles.white` を `style` prop で適用
- Flexbox `flex-1` で左右均等分割 + 中央に縦線
- テストは useScore をモックする可能性を予測

## 実施内容
- tasks.md 3.1「左右チームのスコア表示パネル」を実施
- Requirements: 1.1（横画面左右分割）, 1.2（大きな数字表示）, 2.1（+1加算）, 2.2（-1減算）
- Contract: ScorePanel

## 実装結果（spec-impl の実際の出力）

### 作成/変更ファイル
| ファイル | 操作 | 内容 |
|---------|------|------|
| `src/features/score/components/ScorePanel.tsx` | 新規作成 | 左右スコア表示 + +1/-1 ボタン |
| `src/features/score/components/__tests__/score-panel.test.tsx` | 新規作成 | 11テストケース |
| `App.tsx` | 変更 | プレースホルダーを ScorePanel に置き換え |
| `App.test.tsx` | 変更 | スモークテストを ScorePanel 対応に更新 |

### 主な技術的決定
- `ScoreSide` をファイル内ローカルコンポーネントとして定義（export しない）
- `useWindowDimensions().height * 0.35` でフォントサイズを動的計算
- `glowStyles.white` + `fontSize` を `style` 配列で結合
- 中央分割線は `View` + `w-px bg-btn-border self-stretch` で実現
- テストは useScore をモックせず、実際の ScoreStore を使用した統合テスト

## 予測との乖離
| 項目 | 予測 | 実際 | 差異 |
|------|------|------|------|
| コンポーネント構成 | ScorePanel 内のローカルコンポーネント | ScoreSide をファイル内に定義 | **一致** |
| フォントサイズ | `height * 0.35` | `height * 0.35` | **一致** |
| グロー効果 | `glowStyles.white` をそのまま使用 | `style` 配列で `glowStyles.white` と `fontSize` を結合 | **一致**（配列使用は想定通り） |
| テスト手法 | useScore をモックする可能性 | モックせず統合テスト | **差異あり**（統合テストの方が実用的） |
| App.test.tsx 更新 | 予測なし | 必要だった | **差異あり**（スモークテスト更新は当然の帰結） |

## 意思決定ログ
| 選択肢 | 採用 | 理由 |
|--------|------|------|
| useScore モック vs 統合テスト | 統合テスト | 実際のストアを使用する方がボタンタップ→スコア変更の一連フローを検証でき、信頼性が高い |
| ScoreSide を別ファイルに分離 vs ローカル | ローカル | design.md の Contract は ScorePanel のみ。ScoreSide は内部詳細であり外部公開の必要なし |
| 中央分割線を border vs View | View | `self-stretch` で親の高さに追従でき、独立した testID を付与できる |

## 学び（Lessons Learned）
- React Native コンポーネントテストでは、zustand の `setState()` を `act()` で囲まないと warning が出る
- `useWindowDimensions` はテスト環境でデフォルト値（0）を返すが、フォントサイズの計算テストには影響しない（表示のみ）
- Watchman のタイムアウトは WSL2 環境の既知問題。node crawler へのフォールバックで動作するが、テスト実行に約60-90秒かかる

## テスト結果
- 全 6 スイート / 97 テスト合格
- リグレッションなし
- TDD サイクル: RED → GREEN → REFACTOR 完了
