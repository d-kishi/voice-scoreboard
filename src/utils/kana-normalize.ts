/**
 * 【目的】カタカナをひらがなに変換するユーティリティ
 * 【根拠】音声認識エンジンが「みぎ」「ミギ」のようにひらがな/カタカナの
 *        どちらで返すか一貫性がないため、統一的にマッチングするために使用する。
 *        長音記号「ー」(U+30FC) は変換対象外（ひらがな/カタカナ共通で使われる）。
 */

/**
 * 【目的】文字列中のカタカナ（ア〜ヶ）をひらがな（あ〜ゖ）に変換する
 * 【根拠】Unicode でカタカナとひらがなは 0x60 の差があるため、
 *        charCode を 0x60 減算するだけで変換できる。
 * @param str 変換対象の文字列
 * @returns カタカナがひらがなに変換された文字列
 */
export function katakanaToHiragana(str: string): string {
  return str.replace(/[\u30A1-\u30F6]/g, (ch) =>
    String.fromCharCode(ch.charCodeAt(0) - 0x60)
  );
}

/**
 * 【目的】文字列から長音記号「ー」(U+30FC) を除去する
 * 【根拠】音声認識エンジンが「スコーア」「みぎー」のように長音記号を挿入/付加する
 *        ケースがあるため、長音記号を除去した上でマッチングするフォールバックに使用する。
 *        促音「ッ」「っ」は除去しない（「ロールバック」→「ロルバック」は許容するが
 *        「リセット」→「リセト」にはしたくないため、促音は別文字として扱う）。
 * @param str 変換対象の文字列
 * @returns 長音記号が除去された文字列
 */
export function removeLongVowelMark(str: string): string {
  return str.replace(/\u30FC/g, '');
}
